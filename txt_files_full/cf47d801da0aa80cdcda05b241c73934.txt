Balanced home-away assignments

Projektgruppe OptimiST

Matthias Bultmann
Simon Veltel

Inhaltsübersicht

1. Sportligaplanung

2. Balanced home-away assignments (HAA)

2.1 Veränderungen vornehmen

2.2 Nachbarschaft

2.3 Vorgaben

Folie 01

Sportligaplanung

Kapitel 1

1.  Sportligaplanung

Variablen und Definitionen:

- n Teams, jedes spielt gegen jedes l-mal
(n
2)⋅l
-          Spiele in (n-1)l Runden, n/2 Spiele pro Runde
- falls n ungerade → n+1-“Dummy-Team“ mit nl 
Runden

- normalerweise l = 1 (Single Round Robin) oder

  2 (Double Round Robin)

Folie 02

1.  Sportligaplanung

Variablen und Definitionen:

- Realisierbar als Egde-Coloring-Problem

→ Pro Team ein Knoten
→ Kante (i, j) : i spielt gegen j
→ Färbe Graph mit n-1 Farben
→ Eine Farbe : eine Runde

Folie 03

1.  Sportligaplanung

Variablen und Definitionen:

- Realisierbar als Egde-Coloring-Problem

→ Beispiel mit n = 6 (K6)

3

1

5

2

6

1

5

4

3

Folie 04

2

6

4

Runde 1
Runde 2
Runde 3
Runde 4
Runde 5

Balanced home-away assignment 

(HAA)
Kapitel 2

2. Balanced HAA

Was sind home-away assignments?
→ Spiele werden auswärts (A) oder 

          daheim (H) ausgetragen

→ gerichtete Graphen

1

2

1

2

3

4

3

4

5

6
Ohne Heim-Auswärts
Klassifikation der Spiele

5

6
Mit Heim-Auswärts
Klassifikation der Spiele

Folie 05

2. Balanced HAA

Was sind home-away assignments?

→ Transformation in eine Matrix H (n x n)
    
→ Einträge in H   {∈ H, A}
→ H ist antisymmetrisch : Hij = H →  Hji = A

  (Home-Away Assignment)

3

1

5

2

6

4

3

4

5

2

1
6
1
- A A H A H
2 H - A H H A
3 H H - A A A
4 A A H - H H
5 H A H A - A
6 A H H A H -

Gerichteter Graph

Home-Away Assignment

Folie 06

2. Balanced HAA

Lösen eines Spielplan-Scheduling Problems 
→ Aufbrechen in 2 kleinere Probleme :

- Spielpaarungen und Ablauf (scheduling)
- Spielorte (home-away assignment)

- Variante 1 :

a) Paarungen für die Spiele festlegen (scheduling)
b) Spielorte festlegen (home-away assignment)

- Variante 2 :

a) Spielorte festlegen (home-away assignment)
b) Spieleablauf festlegen (scheduling)

Folie 07

Was ist ein balanced HAA?
→ seien – hi : Heimspiele von Team i

         – ai : Auswärtsspiele von Team i

              – Δi : hi - ai
→ Da  Hij antisymmetrisch ist
         gilt 
     

Δi=0

∑

i=1

n

2. Balanced HAA

5

4

3

2

6 Δi
1
1
- A A H A H -1
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
+1
6 A H H A H -
Home-Away Assignment

Folie 08

2. Balanced HAA

Was ist ein balanced HAA?
→ Ein HAA Hij ist balanciert, falls
n) : Δi   {-1, 0, +1}

∀i   (1...

∈

∈

  

   
     

4

3

2

5

6 Δi
1
- A A H A H -1
1
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
+1
6 A H H A H -

4

3

2

5 Δi
1
- H A H A 0
1
2 A - A H H 0
3 H H - A A 0
4 A A H - H 0
5 H A H A -
0

Balanced HAA für 
n gerade

Balanced HAA für 
n ungerade

Folie 09

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Betrachte ein unbalanciertes HAA

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0 / +1 (n ungerade/gerade)
n) : Δj < 0 / -1 (n ungerade/gerade)  

5

4

3

2

   
     
6 Δi
1
1
- A A H A A -3
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
6 H H H A H -
+3

4

3

2

5 Δi
1
1
- H H H A +2
2 A - A H H 0
3 A H - A A -2
4 A A H - H 0
0
5 H A H A -

Unbalanced HAA  
(n gerade)

Unbalanced HAA
(n ungerade)

Folie 10

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 1 : n ist ungerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0, dies sei Team a (= Team 1)  
n) : Δj < 0, dies sei Team b (= Team 3)

→ Fall 1.1 : Hij = H

→ Lösung : Hij = A
    Hji = H

   
     

4

3

2

5 Δi
1
1
- H H H A +2
2 A - A H H 0
3 A H - A A -2
4 A A H - H 0
0
5 H A H A -
Unbalanced HAA

Folie 11

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 1 : n ist ungerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0, dies sei Team a (= Team 1)  
n) : Δj < 0, dies sei Team b (= Team 3)

→ Fall 1.1 : Hij = H

→ Lösung : Hij = A
    Hji = H

   
     

4

3

2

5 Δi
1
1
- H A H A 0
2 A - A H H 0
3 H H - A A 0
4 A A H - H 0
0
5 H A H A -

Balanced HAA
nach Tausch

Folie 12

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 1 : n ist ungerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0, dies sei Team a (= Team 1)  
n) : Δj < 0, dies sei Team b (= Team 5)

→ Fall 1.2 : Hij = A

→ Tauschen bringt nichts!

   
     

4

3

2

5 Δi
1
1
- H H H A +2
2 A - A H H 0
3 A H - A H 0
4 A A H - H 0
-2
5 H A A A -
Unbalanced HAA

Folie 13

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 1 : n ist ungerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0, dies sei Team a (= Team 1)  
n) : Δj < 0, dies sei Team b (= Team 5)

→ Fall 1.2 : Hij = A

∈

→ ∃k   (1...

n) : Hik = H
   Hjk = A
→ Lösung :  Hik = A, 
     Hki = H,
Hjk = H,
Hkj = A

 
   
     

4

3

2

5 Δi
1
1
- H H H A +2
2 A - A H H 0
3 A H - A H 0
4 A A H - H 0
-2
5 H A A A -
Unbalanced HAA

Folie 14

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 1 : n ist ungerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > 0, dies sei Team a (= Team 1)  
n) : Δj < 0, dies sei Team b (= Team 5)

→ Fall 1.2 : Hij = A

∈

→ ∃k   (1...

n) : Hik = H
   Hjk = A
→ Lösung :  Hik = A, 
     Hki = H,
Hjk = H,
Hkj = A

 
   
     

4

3

2

5 Δi
1
1
- A H H A 0
2 H - A H A 0
3 A H - A H 0
4 A A H - H 0
0
5 H H A A -

Balanced HAA 
nach Tauschkette

Folie 15

2. Balanced HAA

Jedes beliebige HAA kann balanciert werden.
→ Fall 2 : n ist gerade

→ 
→ 

 ∃ i   (1...
 ∃ j   (1...

∈
∈

n) : Δi > +1  
n) : Δj < -1

→ Annahme : Es gibt mehr Teams mit negativem Δi
→ Lösung :
5

2

4

a) Wähle Team a mit positivem Δa
b) Wähle Team b mit negativem Δb

Und  Hab = H 

c) Tausche : Hab = A, Hba = H
d) Falls HAA unbalanced,

springe zu a)

3

6 Δi
1
1
- A A H A A -3
2 H - A H A A -1
3 H H - A A A -1
4 A A H - A H -1
5 H H H H - A +3
6 H H H A H -
+3

 
   

Unbalanced HAA  

Folie 16

2. Balanced HAA

Beispiel zu Fall 2.
→ Lösung :

a) Wähle Team a mit positivem Δa
b) Wähle Team b mit negativem Δb und  Hab = H 
c) Tausche : Hab = A, Hba = H
d) Falls HAA unbalanced, springe zu a)

5

4

3

2

6 Δi
 
1
   
- A A H A A -3
1
     
2 H - A H A A -1
3 H H - A A A -1
4 A A H - A H -1
5 H H H H - A +3
6 H H H A H -
+3

Wähle a = 5
b = {1,2,3,4} 
Wähle b = 4  

Tausch 
H54, H45 

Folie 17

5

4

3

2

6 Δi
1
1
- A A H A A -3
2 H - A H A A -1
3 H H - A A A -1
4 A A H - H H +1
5 H H H A - A +1
6 H H H A H -
+3

Team 5 ist nun balanciert!

2. Balanced HAA

Beispiel zu Fall 2.
→ Lösung :

a) Wähle Team a mit positivem Δa
b) Wähle Team b mit negativem Δb und  Hab = H 
c) Tausche : Hab = A, Hba = H
d) Falls HAA unbalanced, springe zu a)

5

4

3

2

6 Δi
 
1
   
- A A H A A -3
1
     
2 H - A H A A -1
3 H H - A A A -1
4 A A H - H H +1
5 H H H A - A +1
6 H H H A H -
+3

Wähle a = 6
b = {1,2,3} 
Wähle b = 1  

Tausch 
H61, H16 

Folie 18

5

4

3

2

6 Δi
1
1
- A A H A H -1
2 H - A H A A -1
3 H H - A A A -1
4 A A H - H H +1
5 H H H A - A +1
6 A H H A H -
+1

Alle Teams sind balanciert.
→ Fertig!

Balanced home-away assignment (HAA)

Veränderungen vornehmen

Kapitel 2.1

2. 1 Veränderungen

Welche Veränderungen werden vorgenommen?
→ Gegeben : balanciertes HAA Hij
→ Ein Spiel (i ,j) wird geändert

→ Was passiert?

   
     

4

3

2

5

6 Δi
1
- A A H A H -1
1
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
+1
6 A H H A H -

4

3

2

5 Δi
1
- H A H A 0
1
2 A - A H H 0
3 H H - A A 0
4 A A H - H 0
5 H A H A -
0

Gerade Anzahl Teams 
(n = 6)

Ungerade Anzahl Teams 
(n = 5)

Folie 19

2. 1 Veränderungen

→ Was passiert? 
Fall 1 : n ungerade.
→ Änderung eines Spiels (i,j)

→ Δi = -2
→ Δj = +2

→ Lösung : 

→ 

∈

n) : Δk = 0

 ∃ k   (1...
und Hki = H und Hkj = A  

4

3

2

5 Δi
1
1
- H A A A -2
2 A - A H H 0
3 H H - A A 0
4 H A H - H 2
0
5 H A H A -

   
     

Änderung des Spiels
1-4; k = 3

Folie 20

2. 1 Veränderungen

→ Was passiert? 
Fall 1 : n ungerade.
→ Änderung eines Spiels (i,j)

→ Δi = -2
→ Δj = +2

→ Lösung : 

→ 

∈

n) : Δk = 0

 ∃ k   (1...
und Hki = H und Hkj = A

→ Änderung der Spiele

(i,k) und (k,j)  

   
     

4

3

2

5 Δi
1
1
- H H A A 0
2 A - A H H 0
3 A H - H A 0
4 H A A - H 0
0
5 H A H A -

Änderung des Spiele
(1,3) und (3,4)

Folie 21

2. 1 Veränderungen

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

4

5

3

2

6 Δi
1
1
- A A H A H -1
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
6 A H H A H -
+1

Gerade Anzahl Teams 
(n = 6)

→ Fall 2.1 :

→ Fall 2.2 :

→ Fall 2.3 :

→ Fall 2.4 :

Δi = +1, Δj = -1

Δi = -1, Δj = +1

Δi = -1, Δj = -1

Δi = +1, Δj = +1
→ Symmetrisch zu 2.3

  

Folie 22

2. 1 Veränderungen

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

→ Fall 2.1 (Δi = +1, Δj = -1)

4

5

3

2

6 Δi
1
1
- H A H A H +1
2 A - A H H A -1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
6 A H H A H -
+1
Änderung von Spiel 2-1,
noch balanciert

→ Δi = -1
→ Δj = +1
→ Lösung :

→ HAA bleibt balanciert

  

   
     

Folie 23

2. 1 Veränderungen

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

→ Fall 2.2 : (Δi = -1, Δj = +1)

4

5

3

2

6 Δi
1
1
- A A A A H -3
2 H - A H H A +1
3 H H - A A A -1
4 H A H - H H +3
5 H A H A - A -1
6 A H H A H -
+1
Änderung des Spiels 1-4,
k = 5

→ Δi = -3
→ Δj = +3

→ Lösung : 

→ 

∈

 ∃ k   (1...
n) : Δk = +/- 1
und Hki = H und Hkj = A

  

   

Folie 24

2. 1 Veränderungen

4

5

3

2

6 Δi
1
1
- A A A H H -1
2 H - A H H A +1
3 H H - A A A -1
4 H A H - A H +1
5 A A H H - A -1
6 A H H A H -
+1
Änderung des Spiele 1-5 
und 5-4

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

→ Fall 2.2 : (Δi = -1, Δj = +1)

→ Δi = -3
→ Δj = +3

→ Lösung : 

→ 

∈

 ∃ k   (1...
n) : Δk = +/- 1
und Hki = H und Hkj = A

→ Änderung der Spiele

(i,k) und (k,j)  

  

Folie 25

2. 1 Veränderungen

4

5

3

2

6 Δi
1
1
- A H H A H +1
2 H - A H H A +1
3 A H - A A A -3
4 A A H - H H +1
5 H A H A - A -1
6 A H H A H -
+1
Änderung des Spiels 3-1,
k = 6

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

→ Fall 2.3 : (Δi = -1, Δj = -1)

→ Δi = -3
→ Δj = +1

→ Lösung : 

→ 

∈

 ∃ k   (1...
und Hki = H  

n) : Δk = + 1

  

Folie 26

2. 1 Veränderungen

4

5

3

2

6 Δi
1
1
- A H H A H +1
2 H - A H H A +1
3 A H - A A H -1
4 A A H - H H +1
5 H A H A - A -1
6 A H A A H -
-1
Änderung des Spiels 3-6

→ Was passiert? 
Fall 2 : n gerade.
→ Änderung eines Spiels (i,j) von H zu A

→ Fall 2.3 : (Δi = -1, Δj = -1)

→ Δi = -3
→ Δj = +1

→ Lösung : 

→ 

∈

 ∃ k   (1...
und Hki = H

n) : Δk = + 1

→ Änderung des Spiels

(i,k)  

Folie 27

Balanced home-away assignment (HAA)

Nachbarschaft

Kapitel 2.2

2. 2 Nachbarschaft

Definition der Nachbarschaft.
→ Zwei Nachbarschaften N1 und N2.

→ N1 : Zwei (balancierte) HAA's H1, H2 sind benachbart, 

wenn H1 durch eine Spieländerung zu H2 wird. 

5

4

3

2

   
     
6 Δi
1
1
- A A H A H -1
2 H - A H H A +1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
6 A H H A H -
+1

5

4

3

2

6 Δi
1
1
- H A H A H +1
2 A - A H H A -1
3 H H - A A A -1
4 A A H - H H +1
5 H A H A - A -1
+1
6 A H H A H -

Änderung
Von Spiel 1-2

HHA H1

HHA H2

Folie 28

2. 2 Nachbarschaft

Definition der Nachbarschaft.
→ Zwei Nachbarschaften N1 und N2.

→ N2 : Zwei (balancierte) HAA's H1, H2 sind benachbart, 

wenn H1 durch drei Spieländerung zu H2 wird. 

   
     

4

3

2

5 Δi
1
1
- H A H A 0
2 A - A H H 0
3 H H - A A 0
4 A A H - H 0
0
5 H A H A -

4

3

2

5 Δi
1
1
- A A H H 0
2 H - A H A 0
3 H H - A A 0
4 A A H - H 0
0
5 A H H A -

Änderung
Der Spiele
2-1, 1-5, 2-5

HHA H1

HHA H2

Folie 29

2. 2 Nachbarschaft

Definition der Nachbarschaft.

→ Darstellbar als Nachbarschafts-Graphen N1, N2

– Eine Kante (i,j) bedeutet

→ 1 Änderung in N1
→ 3 Änderungen in N2

   
 

     

H1

H2

H3

H4

H5

H6

H7

H8

Nachbarschafts-Graph

Folie 30

2. 2 Nachbarschaft

Definition der Nachbarschaft.

→ N1 : Zwei (balancierte) HAA's H1, H2 sind benachbart, 

wenn H1 durch eine Spieländerung zu H2 wird.

→ N2 : Zwei (balancierte) HAA's H1, H2 sind benachbart, 
wenn H1 durch drei Spieländerungen zu H2 wird.

Definition der erweiterten Nachbarschaft.

→ Es sind auch Spieländerungen erlaubt, sodass H2 nicht  

unmittelbar balanciert ist.

→ Sollte H2 nicht balanciert sein

→ H2 „reparieren“ mit Methoden aus Kapitel 2.1

     

Folie 31

Balanced home-away assignment (HAA)

Vorgaben
Kapitel 2.3

1

2

4

∈
∈

Exkurs: Binäre Matrizen
5 Ri
1
0
1
0
0
2

Gegeben:
→ Zeilensummen Ri
 ∀ i   (1, …, m)
1
 ∀ j   (1, …, n) 
1
→ Spaltensummen Sj
1
→ Menge H fixierter Einträge Hij = 0
1
1
Gesucht:
5
→ Binäre Matrix H, die alle fixierten Werte 
einhält und:
H ij=Ri

1
2
3
4
5
Sj

 ∀ i   (1, …, m)  (Zeilensummen)

∈

0
1
1
0
1
3

0
1
0
1
1
3

3

1
1
0
1
0
3

 3
4
3
3
3

n

∑

j=1

     

m

∑

i=1

H ij=S j

 ∀ j   (1, …, n)  (Spaltensummen)

∈

Folie 32

2. 3 Vorgaben

Definition von Vorgaben.
Gegeben ist ein Set F von Vorgaben.
→   ∀ (i,j) ∈ F : Hij = H

→ Da H antisymmetrisch ist :   ∀ (i,j) ∈ F : Hji = A
→ Antisymmetrie kann ignoriert werden (o.B.)

Notation.
→   ∀ (i,j) ∈ F : Hij = 0 (Alle fixen Einträge sind 0)
→   ∀ (i,i)  : Hij = 0 (Diagonaleinträge sind 0)

     

 

 

Folie 33

2. 3 Vorgaben

Notation.
→ Ri := (n-1) / 2   i   (1, …, n)  
→ Si := (n-1) / 2   i   (1, …, n)  

∀ ∈
∀ ∈

→ n sei ungerade (falls n gerade, „Dummy-Team“)

Frage.
Existiert HAA Hij, sodass alle F erfüllt sind und gilt : 
→ Ri = (n-1) / 2 
→ Si := (n-1) / 2 

∀ ∈
 i   (1, …, n)
∀ ∈
 i   (1, …, n)  

     

 

 

Folie 34

2. 3 Vorgaben

Wie lösen wir dies?  
→ Maximum Flow

Netzwerk G = (V, E) :

→ V = (s1, … ,sn)   (∪ r1, … ,rn)   (∪ q ,s)
→ E = {(q, si) | i = (1, … ,n)}   {(∪ rj, s) | j = (1, … ,n)}

   ∪ {(si, rj) | i,j = (1, … ,n)}

 

Kernaussage.
 ∃ HAA Hij unter F, 

⇔

 maximum Flow in 

G = 

n

∑

i=1

S i

 

 

Folie 35

Beispiel. 
3
1
1
0
1
0
2

1
0
1
1
0
1
2

1
2
3
4
5
Si

2
0
0
0
1
1
2

4
1
1
0
0
1
2

5 Ri
1
2
2
0
1
2
2
1
0
2
2

Beispiel, n = 5
     
Fixierte Einträge sind 0

q

 

 

Folie 36

2. 3 Vorgaben

Knoten q, s und
s1, … , s5, r1, … , r5,
- Kanten zwischen q und si
- Kanten zwischen ri und s
- Vollständiger Graph zwischen si, ri

s1

s2

s3

s4

s5

r1

r2

r3

r4

r5

s

Beispiel. 
3
1
1
0
1
0
2

1
0
1
1
0
1
2

1
2
3
4
5
Si

2
0
0
0
1
1
2

4
1
1
0
0
1
2

5 Ri
1
2
2
0
1
2
2
1
0
2
2

Beispiel, n = 5
     
Fixierte Einträge sind 0

2. 3 Vorgaben

Kapazitäten :
- (q ,si) =  Si 
- (ri ,s) = Ri
- (si, ri) = Hij

2

q

2

2

2

2

s1

s2

s3

s4

s5

2

2

2

2

2

r1

r2

r3

r4

r5

s

 

 

Folie 37

Kapazität 1
Kapazität 0 (Aus F)
Kapazität 0 (Hii)

Beispiel. 
3
1
1
0
0
0
2

1
0
1
1
0
0
2

2
0
0
0
1
1
2

1
2
3
4
5
Si

4
1
0
0
0
1
2

5 Ri
0
2
2
0
1
2
2
1
0
2
2

Rote Kanten auf 1 gesetzt
     

2. 3 Vorgaben

Maximum Flow =         = 10 

S i

n

∑

i=1

2

q

2

2

2

2

s1

s2

s3

s4

s5

2

2

2

2

2

r1

r2

r3

r4

r5

s

 

 

Folie 38

2. 3 Vorgaben

Beispiel.
Hij ist nicht mehr antisymmetrisch!

Theorem.
Falls gilt :
∀ ∈
→ Ri = (n-1) / 2 
 j   (1, …, n),
∀ ∈
→ Si := (n-1) / 2 
 i   (1, …, n),
kann Hij durch Umkehrungen 
antisymmetrisch werden. (o.B.) 
 
 

 

 

Folie 39

1
0
1
1
0
0
2

2
0
0
0
1
1
2

3
1
1
0
0
0
2

4
1
0
0
0
1
2

5 Ri
0
2
2
0
1
2
2
1
0
2
2

1
2
3
4
5
Si

Nicht mehr anti-symmetrisch!

Balanced home-away assignments

Projektgruppe OptimiST

Matthias Bultmann
Simon Veltel

