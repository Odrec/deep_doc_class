 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Computer Vision 

10 − Template Matching 

WS 2014 / 2015 

Gunther Heidemann 

Object recognition by template matching 

First approach to object recognition: 

1. Make a template, i.e., a simplified image that serves as a 

prototypic model of the object. 

2. Search for the template in the image. 

This approach is called template matching. 

 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

2 

Template Matching 

Principle: 

 Compute similarity between the  

 template   

T(i,j) 

i = 1…m, 

j = 1…n,  with m, n odd, and 

 the image 

g(x,y),   x = 1…M,  y = 1…N, 

at each location (x,y). 

 Procedure:  Template moves across the image like a convolution 

kernel. 

 

 

 

 Similarity measures: 

1. Mean absolute difference (MAD), 

2. Correlation coefficient. 

CV-10  Template Matching 

3 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Mean absolute difference (MAD) 

 

 

 

 We need a measure for similarity / distance between template T(i,j) 

and image g(x,y). 

 Simple idea:  Mean difference of the gray values! 

  MAD(x,y) = 1/mn · Sij |g(x+i,y+j) − T(i,j)| 

   

 

 

 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

4 

Template Matching (MAD) 

Image 

Template 

Maximum is located at the 
center of the shape we are 
looking for. 

CV-10  Template Matching 

-MAD(x,y) 

[T] 

5 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Template Matching (MAD):  Noise 

Image 

Template Torg 

Due to the intergration, template matching is 
robust against noise. 

CV-10  Template Matching 

-MAD(x,y) 

[T] 

6 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Template Matching (MAD):  Problems 

Image 

Template (Rot[Torg,15°]) 

Non-perfect match: Values of 
the local maxima become 
comparable. 

CV-10  Template Matching 

-MAD(x,y) 

[T] 

7 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Template Matching (MAD):  Problems 

Image 

Template 

(0.5·Torg) 

Incorrect scaling of the gray values of the 
template:  Local maxima disturbed. 

CV-10  Template Matching 

-MAD(x,y) 

[T] 

8 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Template Matching (MAD):  Problems 

Image 

Template (Torg-120) 

Wrong average gray value of the template:  
Local maxima disturbed. 

CV-10  Template Matching 

-MAD(x,y) 

[T] 

9 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Correlation coefficient 

 

 Problem of MAD:  Does not only judge shape match, but also 

absolute gray values. 

 Better:  Correlation coefficient between g(x,y) and T(i,j) (with the 

same range of definition): 

 

   

 

 

 

Cg,T = sg,T / sg∙sT, 

  where sg,T(x,y) is the covariance between g and T(i,j), 

  and sg,sT  are the standard deviations of g and T, resp. 

 

 

 

 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

10 

Correlation coefficient 

 

 Maximum correlation C = 1  ↔  Patterns are identical up to a 

linear transform  T´ = a∙T + b  with  a > 0. 

 Minimum correlation C = −1  ↔  Patterns are identical up to a 

linear transform  T´ = a∙T + b  with  a < 0. 

 Correlation can be obtained from convolution, if the mean value of 

T is 0. 

 For real patterns, T is too large for direct computation  Fourier 

transform. 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

11 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Correlation 

Scaling of the gray values does not matter! 

CV-10  Template Matching 

[T] 

12 

Correlation coefficient 

Correlation can be computed by convolution for an image g(x,y) and a 
(2m+1)x(2n+1) - template T with zero mean: 

 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

13 

0,   since    ,,,1,,1,,1,,,,mminnjmminnjTgmminnjTgmminnjTgTgTgTgjnimTjnimTjyixgjnimTgjyixgTjnimTgjyixgyxyxCsssssssssTemplate Matching using the correlation coefficient 

Torg 

0.5 Torg 

Torg -120 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Results of correlation for optimal / scaled / reduced template values. 

CV-10  Template Matching 

[T] 

14 

Template Matching using the correlation coefficient 

Template 

Image 

Correlation 
coefficient 

Image  
+ noise 

Correlation- 
coefficient 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

15 

Template Matching 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

16 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Template Matching 

The ratio of the 
intensity values in 
the template must 
match the original 
gray value ratio. 

 

CV-10  Template Matching 

17 

Does biological vision work like template matching? 

 Is there a cell / template in brain for each object we know? 

 For example, a cell for your grandmother (“grandmother cell”) 

 We would need not just one cell for each object, but one cell for 

each “view” of the object, depending on 

 viewpoint 

 size / distance 

 illumination direction(s) 

 illumination spectra 

 … 

 Combinatorial explosion ! 

Lots of „visual  
degrees of freedom“ ! 

 Grandmother cells in the sense of templates can not exist. 

   

 

 

 

CV-10  Template Matching 

18 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

Grandmother cells 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

CV-10  Template Matching 

19 

Literature and sources 

 

e
c
n
e

i

c
S
e
v

 

i
t
i
n
g
o
C

 

 
f
o
e
t
u
t
i
t
s
n

I
 
,

k
c
ü
r
b
a
n
s
O

 
f
o
y
t
i

 

s
r
e
v
n
U

i

[T]  Klaus D. Tönnies, Grundlagen der Bildverarbeitung,  Pearson Studium, 2005. 

[J]   Bernd Jähne, Digitale Bildverarbeitung, Springer, 2005. 

[FP]  David Forsyth, Jean Ponce, Computer Vision: A Modern Approach, Prentice Hall, 

2002. 

[SS]  Linda G. Shapiro, George C. Stockman, Computer Vision, Prentice Hall, 2001. 

[BK]   Henning Bässmann, Jutta Kreyss, Bildverarbeitung Ad Oculos, Springer, 2004. 

[He]  Hecht, Optics, Addison-Wesley, 1987. 

[L]  David Lowe, Slides, http://www.cs.ubc.ca/~lowe/425/. 
[A]   Artexplosion Explosion® Photo Gallery, Nova Development Corporation, 23801 

Calabasas Road, Suite 2005 Calabasas, California 91302-1547, USA. 

[C]   Corel GALLERY™ Magic 65000, Corel Corporation, 1600 Carling Ave., Ottawa, 

Ontario, Canada K1Z 8R7. 

[V]  Vision Texture Database (VisTex). R. Picard, C. Graczyk, S. Mann, J. Wachman, 

L. Picard and L. Campbell. Media Laboratory, MIT. Copyright 1995 by the 
Massachusetts Institute of Technology. 
http://vismod.media.mit.edu/vismod/imagery/VisionTexture/vistex.html 

[COIL] 

S.A. Nene, S.K. Nayar, H. Murase: Columbia Object Image Library: COIL-

100, Technical Report, Dept. of  Computer Science, Columbia Univ., CUCS-006-
96, 1996. 

[H]  Copyright Gunther Heidemann, 2008. 

 

CV-10  Pattern Recognition 

20 

